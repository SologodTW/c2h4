{%- comment -%}
	{% render 'c-item-variants',
		item: selectedVariant,
		is_hide_label: false %}

	- item: variant object
	- is_hide_label: hide selection label
	- is_variant_pills: pill shaped selectors, opposed to <select>
	- is_prechecked: select the first or available variant on load
	- is_single_selector: disable variant grouping
	- is_show_selected_variant_in_label: Used when the selection label is hidden, such as color swatches.
{%- endcomment -%}

{%- liquid
	assign item_product = item.product
	assign uniq_range = 9999999 | minus: 1
	assign uniq_id = 'now' | date: '%N' | modulo: uniq_range | plus: 1

	if is_single_selector == true
		assign variant_groups = ' ' | split: ''
	else
		assign variant_groups = item_product.options_with_values
	endif

	if is_prechecked != true and item_product.selected_variant != null
		assign is_prechecked = true
	elsif is_prechecked == null
		assign is_prechecked = false
	endif
%}

{%- if item_product.has_only_default_variant == false -%}
	<div class="c-item-variants">
		{%- for product_option in variant_groups -%}
			{%- liquid
				if is_single_selector == true
					assign variant_group_name = 'Option'
					assign variant_group_values = item_product.variants

					if is_prechecked == true
						assign variant_group_selected_value = item.title
					else
						assign variant_group_selected_value = ''
					endif

				else
					assign variant_group_name = product_option.name
					assign variant_group_values = product_option.values

					if is_prechecked == true
						assign variant_group_selected_value = product_option.selected_value
					else
						assign variant_group_selected_value = ''
					endif
				endif

				assign variant_group_handle = variant_group_name | prepend: 'variant-group-' | append: '-' | append: uniq_id | handleize
			%}

			<div class="c-item-variants__group {{ variant_group_handle }} js-variant-group">
				{%- comment -%}
					Can intermix selection type based on variant option name. For example:

					{%- assign variant_option_handle = variant_group_name | handleize -%}
					{% if variant_option_handle == 'color' or variant_option_handle == 'colour' %} xxx {% endif %}
				{%- endcomment -%}
				{%- if is_variant_pills == true -%}
					<fieldset class="c-item-variants__pills f-h f-w f-a-c user-select-disable">
						<div
							class="c-item-variants__pills__title t-h-2 {%- if is_hide_label == true %} screen-reader-only{%- endif -%}"
						>
							{{- variant_group_name -}}

							{%- if is_show_selected_variant_in_label == true -%}
								<span
									class="c-item-variants__pills__selected t-l-3 js-variant-pills-selected"
									data-label=""
									data-label-current="{{- variant_group_selected_value -}}"
								></span>
							{%- endif -%}
						</div>

						<div class="c-item-variants__pills__items f-h f-a-c">
							{%- for value in variant_group_values -%}
								{%- liquid
									if is_single_selector == true
										assign value_id = value.id
										assign value_title = value.title
										assign variant_avail = value.available

									else
										assign value_id = value
										assign value_title = value
										assign variant_avail = true
									endif

									if variant_group_name == 'Size'
										assign value_title_h = value_title | remove: '-' | handle | strip

										case value_title_h
											when 'xsmall'
												assign value_title_label = 'XS'
											when 'small'
												assign value_title_label = 'S'
											when 'medium'
												assign value_title_label = 'M'
											when 'large'
												assign value_title_label = 'L'
											when 'xlarge'
												assign value_title_label = 'XL'
										endcase
									endif
								-%}
								<div class="c-item-variants__pills__item">
									<input
										type="radio"
										id="{{- variant_group_handle | append: '-' | append: forloop.index -}}"
										class="p-fill js-variant-selector"
										name="{{ variant_group_handle }}"
										value="{{- value_id -}}"
										data-label="{{- value_title -}}"
										required
										{%- if variant_group_name == 'Color' %}
											data-swatch-color="{{ value_title | handle }}"
										{% endif %}
										{%- if variant_group_selected_value == value_title
											and is_prechecked == true
										%}
											checked
										{%- endif %}
										{%- if variant_avail != true %}
											disabled
										{%- endif %}
									>
									<label {% if variant_group_name == 'Color' %}class="screen-reader-only"{% endif %} for="{{- variant_group_handle | append: '-' | append: forloop.index -}}">
										{%- if variant_group_name == 'Size' %}{{- value_title_label -}}{%- else -%}{{- value_title -}}{%- endif -%}
									</label>
								</div>
							{%- endfor -%}
						</div>
					</fieldset>

				{%- else -%}
					<div class="c-field">
						<label
							{%- if is_hide_label == true %}
								class="screen-reader-only"
							{%- endif -%}
							for="{{ variant_option_group_handle }}"
						>
							{{- variant_group_name | prepend: 'Select ' -}}
						</label>

						<div class="c-custom-select js-variant-selector" data-required="true">
							<div class="c-custom-select__trigger" tabindex="0" role="button" aria-haspopup="listbox">
								<span class="c-custom-select__value">
									{%- if is_prechecked == false -%}
										-
									{%- else -%}
										{%- for value in variant_group_values -%}
											{%- liquid
												if is_single_selector == true
													assign value_id = value.id
													assign value_title = value.title
												else
													assign value_id = value
													assign value_title = value
												endif
											-%}
											{%- if variant_group_selected_value == value_title -%}
												{{- value_title -}}
												{%- break -%}
											{%- endif -%}
										{%- endfor -%}
									{%- endif -%}
								</span>
								<span class="c-custom-select__arrow">â–¼</span>
							</div>
							<div class="c-custom-select__dropdown" role="listbox">
								{%- if is_prechecked == false -%}
									<div class="c-custom-select__option" data-value="" role="option">-</div>
								{%- endif -%}

								{%- for value in variant_group_values -%}
									{%- liquid
										if is_single_selector == true
											assign value_id = value.id
											assign value_title = value.title
											assign variant_avail = value.available

										else
											assign value_id = value
											assign value_title = value
											assign variant_avail = true
										endif
									-%}

									<div
										class="c-custom-select__option{% if variant_group_selected_value == value_title and is_prechecked == true %} c-custom-select__option--selected{% endif %}{% if variant_avail == false %} c-custom-select__option--disabled{% endif %}"
										data-value="{{- value_id -}}"
										role="option"
										{%- if variant_avail == false %}
											aria-disabled="true"
										{%- endif %}
									>
										{{- value_title -}}
										{%- if variant_avail == false %} - sold out{%- endif %}
									</div>
								{%- endfor -%}
							</div>
						</div>
					</div>
				{%- endif -%}
			</div>
		{%- endfor -%}
	</div>
{%- endif -%}